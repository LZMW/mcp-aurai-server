# ä¸Šçº§é¡¾é—® MCP (Aurai Advisor) - ç”¨æˆ·æ‰‹å†Œ

> **ç‰ˆæœ¬**: v2.1 | **å®Œæˆåº¦**: 100% | **æ›´æ–°æ—¥æœŸ**: 2026-01-21

---

## ğŸ“– ç›®å½•

0. [Claude Code å¿«é€Ÿå…¥é—¨](#0-claude-code-å¿«é€Ÿå…¥é—¨) â­ æ–°
1. [å¿«é€Ÿå¼€å§‹](#1-å¿«é€Ÿå¼€å§‹)
2. [é…ç½®æŒ‡å—](#2-é…ç½®æŒ‡å—)
3. [ä½¿ç”¨æ–¹æ³•](#3-ä½¿ç”¨æ–¹æ³•)
4. [å¸¸è§é—®é¢˜](#4-å¸¸è§é—®é¢˜-faq)
5. [è¿›é˜¶æŠ€å·§](#5-è¿›é˜¶æŠ€å·§)

---

## 0. Claude Code å¿«é€Ÿå…¥é—¨ â­

> **æ¨è**: ä½¿ç”¨ Claude Code ä½“éªŒæ›´ä½³çš„ MCP é›†æˆ

### 0.1 ä¸€é”®å®‰è£…

```bash
# 1. å®‰è£…ä¾èµ–
cd C:\Users\29493\Desktop\mcp-aurai-server
pip install -e .

# 2. é…ç½® MCPï¼ˆä¸€é”®å‘½ä»¤ï¼‰
claude mcp add aurai-advisor \
  -e AURAI_API_KEY="your-api-key" \
  -e AURAI_PROVIDER="custom" \
  -e AURAI_BASE_URL="https://www.chatgtp.cn/v1" \
  -e AURAI_MODEL="deepseek-v3-1-250821" \
  -- "C:\Users\29493\Desktop\mcp-aurai-server/venv/Scripts/python.exe" -m mcp_aurai.server

# 3. éªŒè¯å®‰è£…
claude mcp list
```

### 0.2 å¼€å§‹ä½¿ç”¨

åœ¨ Claude Code å¯¹è¯ä¸­ç›´æ¥æè¿°ä½ çš„ç¼–ç¨‹é—®é¢˜ï¼š

```
æˆ‘é‡åˆ°äº†ä¸€ä¸ª KeyError: 'api_key'ï¼Œä»£ç å¦‚ä¸‹ï¼š
[ç²˜è´´ä»£ç ]
```

å½“é‡åˆ°å¤æ‚é—®é¢˜æ—¶ï¼ŒClaude Code ä¼šè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨ `consult_aurai` å·¥å…·å‘ä¸Šçº§ AI å’¨è¯¢ã€‚

### 0.3 å¸¸ç”¨å‘½ä»¤

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| æŸ¥çœ‹é…ç½® | `claude mcp get aurai-advisor` |
| åˆ—å‡ºæ‰€æœ‰ MCP | `claude mcp list` |
| åˆ é™¤é…ç½® | `claude mcp remove aurai-advisor -s local` |
| æ›´æ–°é…ç½® | åˆ é™¤åé‡æ–°æ·»åŠ  |

### 0.4 å®Œæ•´æ–‡æ¡£

ğŸ“– [Claude Code ä¸“ç”¨å®‰è£…æŒ‡å—](CLAUDE_CODE_INSTALL.md)

---

## 1. å¿«é€Ÿå¼€å§‹

### 1.1 é¡¹ç›®ç®€ä»‹

**ä¸Šçº§é¡¾é—® MCP** æ˜¯ä¸€ä¸ªåˆ›æ–°å·¥å…·ï¼Œè®©æœ¬åœ° AI èƒ½å¤Ÿè·å–è¿œç¨‹ AI çš„æŒ‡å¯¼ï¼Œé€šè¿‡è¿­ä»£å¼å¯¹è¯è§£å†³ç¼–ç¨‹é—®é¢˜ã€‚

**æ ¸å¿ƒç‰¹æ€§**:
- [OK] æ”¯æŒ 5 ç§ AI æä¾›å•†ï¼ˆzhipu, openai, anthropic, gemini, customï¼‰
- [OK] åŠ¨æ€æ¨¡å‹è·å–ï¼ˆå®æ—¶è·å–æœ€æ–°æ¨¡å‹ï¼‰
- [OK] å¯¹è¯å†å²æŒä¹…åŒ–ï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰
- [OK] æ™ºèƒ½å¯¹è¯ç®¡ç†ï¼ˆè‡ªåŠ¨æ£€æµ‹æ–°é—®é¢˜å¹¶æ¸…ç©ºå†å²ï¼‰
- [OK] Windows GUI é…ç½®å·¥å…·
- [OK] å®Œæ•´æµ‹è¯•è¦†ç›–ï¼ˆ27 ä¸ªæµ‹è¯•ï¼Œ100% é€šè¿‡ï¼‰

### 1.2 å®‰è£…æ­¥éª¤

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\Users\29493\Desktop\mcp-aurai-server

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# 3. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆWindowsï¼‰
venv\Scripts\activate

# 4. å®‰è£…ä¾èµ–
pip install -e ".[all-dev]"

# 5. è¿è¡Œæµ‹è¯•éªŒè¯
pytest tests/ -v
```

**é¢„æœŸè¾“å‡º**:
```
========== 27 passed in 2.34s ==========
```

### 1.3 å¿«é€Ÿé…ç½®

#### æ–¹å¼ 1: ä½¿ç”¨ GUI é…ç½®å·¥å…·ï¼ˆæ¨èï¼‰

```bash
venv\Scripts\python tools\control_center.py
```

**é…ç½®æ­¥éª¤**:
1. è¾“å…¥ API å¯†é’¥
2. é€‰æ‹© AI æä¾›å•†
3. ï¼ˆcustom æä¾›å•†ï¼‰è¾“å…¥ Base URL
4. ç‚¹å‡»"åˆ·æ–°æ¨¡å‹"è·å–æ¨¡å‹åˆ—è¡¨
5. é€‰æ‹©æ¨¡å‹
6. ç‚¹å‡»"ä¿å­˜é…ç½®"ï¼Œç”Ÿæˆçš„å‘½ä»¤å¯ç›´æ¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ

#### æ–¹å¼ 2: å‘½ä»¤è¡Œé…ç½®

ä½¿ç”¨ `claude mcp add` å‘½ä»¤ï¼š

```bash
claude mcp add aurai-advisor \
  -e AURAI_API_KEY="your-api-key" \
  -e AURAI_PROVIDER="custom" \
  -e AURAI_BASE_URL="https://www.chatgtp.cn/v1" \
  -e AURAI_MODEL="deepseek-v3-1-250821" \
  -- "C:\Users\29493\Desktop\mcp-aurai-server/venv/Scripts/python.exe" -m mcp_aurai.server
```

### 1.4 å¼€å§‹ä½¿ç”¨

1. **é‡å¯ Claude Code**
2. **åœ¨å¯¹è¯ä¸­ç›´æ¥æè¿°ä½ çš„ç¼–ç¨‹é—®é¢˜**ï¼š
   ```
   æˆ‘é‡åˆ°äº†ä¸€ä¸ª KeyError é—®é¢˜ï¼Œé”™è¯¯ä¿¡æ¯æ˜¯ 'api_key' not found
   ç›¸å…³ä»£ç å¦‚ä¸‹ï¼š
   [ç²˜è´´ä»£ç ]
   ```
3. **AI ä¼šè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨ consult_aurai å·¥å…·**
   - å¯¹äºå¤æ‚é—®é¢˜æˆ–éœ€è¦æ·±åº¦åˆ†æçš„æƒ…å†µï¼ŒAI ä¼šä¸»åŠ¨å‘ä¸Šçº§ AI å’¨è¯¢
   - ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šå‘½ä»¤æˆ–è¯­æ³•

---

## 2. é…ç½®æŒ‡å—

### 2.1 æ”¯æŒçš„ AI æä¾›å•†

| æä¾›å•† | è¯´æ˜ | è·å– API å¯†é’¥ | æ¨èæ¨¡å‹ |
|--------|------|--------------|----------|
| **zhipu** | æ™ºè°± AI | https://open.bigmodel.cn/ | glm-4-flash |
| **openai** | OpenAI å®˜æ–¹ | https://platform.openai.com/api-keys | gpt-4o |
| **anthropic** | Claude | https://console.anthropic.com/ | claude-3-5-sonnet-20241022 |
| **gemini** | Google Gemini | https://makersuite.google.com/app/apikey | gemini-2.0-flash-exp |
| **custom** | ç¬¬ä¸‰æ–¹ä¸­è½¬ç«™ | å–å†³äºæä¾›å•† | å–å†³äºæä¾›å•† |

### 2.2 è·å– API å¯†é’¥

#### æ™ºè°± AIï¼ˆæ¨èæ–°æ‰‹ï¼‰

1. è®¿é—® https://open.bigmodel.cn/
2. æ³¨å†Œè´¦å·ï¼ˆå…è´¹èµ é€é¢åº¦ï¼‰
3. è¿›å…¥ã€ŒAPI Keyã€é¡µé¢
4. åˆ›å»ºæ–°çš„ API Key

#### OpenAI

1. è®¿é—® https://platform.openai.com/api-keys
2. ç™»å½•è´¦å·ï¼ˆéœ€è¦ç»‘å®šä¿¡ç”¨å¡ï¼‰
3. ç‚¹å‡» "Create new secret key"

#### Claude (Anthropic)

1. è®¿é—® https://console.anthropic.com/
2. æ³¨å†Œè´¦å·ï¼ˆéœ€è¦å¢ƒå¤–ä¿¡ç”¨å¡ï¼‰
3. è¿›å…¥ "API Keys" é¡µé¢åˆ›å»ºå¯†é’¥

#### Google Gemini

1. è®¿é—® https://makersuite.google.com/app/apikey
2. åˆ›å»ºé¡¹ç›®æˆ–é€‰æ‹©ç°æœ‰é¡¹ç›®
3. ç”Ÿæˆ API Key

#### è‡ªå®šä¹‰ APIï¼ˆç¬¬ä¸‰æ–¹ä¸­è½¬ç«™ï¼‰

æ¨èçš„ä¸­è½¬ç«™ï¼š
- **chatgtp.cn**: https://www.chatgtp.cnï¼ˆä»·æ ¼ä¼˜æƒ ï¼Œæ”¯æŒå¤šæ¨¡å‹ï¼‰
- å…¶ä»– OpenAI å…¼å®¹çš„ä¸­è½¬ç«™

### 2.3 é…ç½®å‚æ•°è¯´æ˜

#### åŸºç¡€é…ç½®

| å‚æ•° | è¯´æ˜ | å¿…éœ€ | é»˜è®¤å€¼ |
|------|------|------|--------|
| `AURAI_API_KEY` | API å¯†é’¥ | [OK] æ˜¯ | - |
| `AURAI_PROVIDER` | AI æä¾›å•† | [X] | zhipu |
| `AURAI_MODEL` | æ¨¡å‹åç§° | [X] | glm-4-flash |
| `AURAI_BASE_URL` | Base URL | [X] | - |

#### é«˜çº§é…ç½®

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | å»ºè®®èŒƒå›´ |
|------|------|--------|----------|
| `AURAI_MAX_ITERATIONS` | æœ€å¤§è¿­ä»£æ¬¡æ•° | 10 | 5-20 |
| `AURAI_MAX_HISTORY` | å¯¹è¯å†å²æœ€å¤§ä¿å­˜æ•° | 50 | 10-100 |
| `AURAI_TEMPERATURE` | æ¸©åº¦å‚æ•° | 0.7 | 0.0-1.0 |
| `AURAI_MAX_TOKENS` | æœ€å¤§ tokens | 4096 | 2048-8192 |
| `AURAI_HISTORY_PATH` | å†å²æ–‡ä»¶è·¯å¾„ | ~/.mcp-aurai/history.json | è‡ªå®šä¹‰è·¯å¾„ |
| `AURAI_LOG_LEVEL` | æ—¥å¿—çº§åˆ« | INFO | DEBUG/INFO/WARNING/ERROR |

### 2.4 Base URL æ ¼å¼

**é‡è¦æç¤º**:
- [OK] æ­£ç¡®: `https://www.chatgtp.cn/v1`
- [X] é”™è¯¯: `https://www.chatgtp.cn/v1/chat/completions`

**è¯´æ˜**: SDK ä¼šè‡ªåŠ¨åœ¨ Base URL åæ·»åŠ å¯¹åº”çš„æ¥å£è·¯å¾„ï¼ˆå¦‚ `/models`, `/chat/completions`ï¼‰

### 2.5 ç¯å¢ƒå˜é‡é…ç½®

**åˆ›å»º `.env` æ–‡ä»¶**:
```bash
# å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶
copy .env.example .env

# ç¼–è¾‘é…ç½®
notepad .env
```

**`.env` æ–‡ä»¶å†…å®¹**:
```bash
# å¿…éœ€é…ç½®
AURAI_API_KEY=your-api-key-here

# å¯é€‰é…ç½®
AURAI_PROVIDER=zhipu
AURAI_MODEL=glm-4-flash
AURAI_BASE_URL=https://open.bigmodel.cn/api/paas/v4/
AURAI_MAX_ITERATIONS=10
AURAI_MAX_HISTORY=50
AURAI_TEMPERATURE=0.7
AURAI_MAX_TOKENS=4096
AURAI_HISTORY_PATH=C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json
AURAI_LOG_LEVEL=INFO
```

---

## 3. ä½¿ç”¨æ–¹æ³•

### 3.1 MCP å·¥å…·è¯´æ˜

#### å·¥å…· 1: consult_auraiï¼ˆä¸»è¦å·¥å…·ï¼‰

**åŠŸèƒ½**: è¯·æ±‚ä¸Šçº§ AI æŒ‡å¯¼è§£å†³ç¼–ç¨‹é—®é¢˜

**å‚æ•°**:
- `problem_type`: é—®é¢˜ç±»å‹ï¼ˆruntime_error, syntax_error, design_issue, otherï¼‰
- `error_message`: é”™è¯¯æè¿°
- `code_snippet`: ä»£ç ç‰‡æ®µï¼ˆå¯é€‰ï¼‰
- `context`: ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
- `attempts_made`: å·²å°è¯•çš„æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰
- `is_new_question`: æ˜¯å¦ä¸ºæ–°é—®é¢˜ï¼ˆå¯é€‰ï¼Œé»˜è®¤falseï¼‰
  - è®¾ç½®ä¸º `true` ä¼šæ¸…ç©ºä¹‹å‰çš„æ‰€æœ‰å¯¹è¯å†å²
  - é€‚ç”¨äºåˆ‡æ¢åˆ°å®Œå…¨ä¸åŒçš„é—®é¢˜æ—¶
  - ä¹‹å‰çš„é—®é¢˜å’Œä¸Šçº§AIçš„æŒ‡å¯¼éƒ½ä¼šè¢«åˆ é™¤
  - å½“å‰è¿™æ¡æ–°é—®é¢˜ä¼šæ­£å¸¸å¤„ç†å¹¶ä¿ç•™

**è¿”å›**:
```json
{
  "analysis": "é—®é¢˜æ ¹å› åˆ†æ",
  "guidance": "è¯¦ç»†æŒ‡å¯¼å»ºè®®",
  "action_items": ["æ­¥éª¤1", "æ­¥éª¤2"],
  "code_changes": ["ä»£ç ä¿®æ”¹å»ºè®®"],
  "resolved": true
}
```

**ä½¿ç”¨ç¤ºä¾‹**:
```
ç”¨æˆ·: æˆ‘é‡åˆ°äº†ä¸€ä¸ª KeyError: 'api_key'ï¼Œä»£ç å¦‚ä¸‹ï¼š
config = load_config()
api_key = config['api_key']  # è¿™é‡ŒæŠ¥é”™

[AI åˆ¤æ–­é—®é¢˜å¤æ‚åº¦åï¼Œå¯èƒ½ä¼šè°ƒç”¨ consult_aurai å·¥å…·è·å–ä¸Šçº§ AI çš„åˆ†æ]
```

#### å·¥å…· 2: sync_context

**åŠŸèƒ½**: åŒæ­¥ä»£ç ä¸Šä¸‹æ–‡æˆ–ç®¡ç†å¯¹è¯å†å²

**å‚æ•°**:
- `operation`: æ“ä½œç±»å‹ï¼ˆfull_sync, incremental, clearï¼‰
- `files`: æ–‡ä»¶è·¯å¾„åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰
- `project_info`: é¡¹ç›®ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰

#### å·¥å…· 3: report_progress

**åŠŸèƒ½**: æŠ¥å‘Šæ‰§è¡Œè¿›åº¦å’Œç»“æœ

**å‚æ•°**:
- `actions_taken`: å·²æ‰§è¡Œçš„è¡ŒåŠ¨
- `result`: æ‰§è¡Œç»“æœï¼ˆsuccess, failed, partialï¼‰
- `new_error`: æ–°çš„é”™è¯¯ï¼ˆå¯é€‰ï¼‰
- `feedback`: åé¦ˆï¼ˆå¯é€‰ï¼‰

#### å·¥å…· 4: get_status

**åŠŸèƒ½**: è·å–æœåŠ¡å™¨å½“å‰çŠ¶æ€

**è¿”å›**:
```json
{
  "status": "running",
  "provider": "custom",
  "model": "deepseek-v3-1-250821",
  "history_count": 42
}
```

### 3.2 å¯¹è¯å†å²ç®¡ç†

**æ™ºèƒ½å¯¹è¯ç®¡ç†**:

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æ–°é—®é¢˜å¹¶æ¸…ç©ºå¯¹è¯å†å²ï¼Œç¡®ä¿æ¯ä¸ªé—®é¢˜éƒ½æœ‰å¹²å‡€çš„ä¸Šä¸‹æ–‡ï¼š

1. **è‡ªåŠ¨æ¸…ç©º**ï¼šå½“ä¸Šçº§AIè¿”å› `resolved=true` æ—¶ï¼Œè‡ªåŠ¨æ¸…ç©ºå†å²
2. **æ‰‹åŠ¨æ¸…ç©º**ï¼šè®¾ç½® `is_new_question=true` å¼ºåˆ¶æ¸…ç©ºå†å²
3. **å†å²é™åˆ¶**ï¼šé»˜è®¤æœ€å¤šä¿å­˜50æ¡å†å²è®°å½•ï¼ˆå¯é€šè¿‡ `AURAI_MAX_HISTORY` é…ç½®ï¼‰

**ä½•æ—¶è®¾ç½® `is_new_question=true`ï¼Ÿ**
- åˆ‡æ¢åˆ°å®Œå…¨ä¸ç›¸å…³çš„é¡¹ç›®/æ–‡ä»¶
- ä¹‹å‰çš„é—®é¢˜å·²è§£å†³ï¼Œç°åœ¨é‡åˆ°å…¨æ–°çš„é—®é¢˜
- å‘ç°ä¸Šä¸‹æ–‡æ··ä¹±ï¼Œæƒ³é‡æ–°å¼€å§‹
- **ä¸è¦**åœ¨åŒä¸€ä¸ªé—®é¢˜çš„å¤šè½®å¯¹è¯ä¸­ä½¿ç”¨

**è¿­ä»£å¯¹è¯æœºåˆ¶**:

**å·¥ä½œåŸç†**:
1. æœ¬åœ° AI å‘èµ·å’¨è¯¢è¯·æ±‚
2. ä¸Šçº§ AI åˆ†æé—®é¢˜å¹¶æä¾›å»ºè®®
3. æœ¬åœ° AI å°è¯•æ‰§è¡Œå»ºè®®
4. å¦‚æœæœªè§£å†³ï¼Œè¿›å…¥ä¸‹ä¸€è½®è¿­ä»£ï¼ˆæœ€å¤š 10 è½®ï¼‰
5. æ¯è½®å¯¹è¯åŒ…å«å¯¹è¯å†å²ï¼ˆä¸Šé™ç”± `max_history` æ§åˆ¶ï¼‰

**è¿­ä»£æ¬¡æ•°é…ç½®**:
```json
{
  "env": {
    "AURAI_MAX_ITERATIONS": "15"  // å¢åŠ åˆ° 15 è½®
  }
}
```

### 3.3 å¯¹è¯å†å²ç®¡ç†

**è‡ªåŠ¨ä¿å­˜**: æ¯æ¬¡å¯¹è¯åè‡ªåŠ¨ä¿å­˜åˆ°æ–‡ä»¶

**é»˜è®¤ä½ç½®**: `C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json`

**æŸ¥çœ‹å†å²**:
```bash
# æŸ¥çœ‹å†å²æ–‡ä»¶
type C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json

# æˆ–ä½¿ç”¨ç¼–è¾‘å™¨
notepad C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json
```

**æ¸…ç©ºå†å²**:
```bash
# è°ƒç”¨ sync_context å·¥å…·ï¼Œè®¾ç½® operation="clear"
# æˆ–æ‰‹åŠ¨åˆ é™¤æ–‡ä»¶
del C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json
```

### 3.4 æ¨¡å‹é€‰æ‹©

#### åŠ¨æ€è·å–æ¨¡å‹åˆ—è¡¨

**æ–¹æ³• 1: GUI å·¥å…·**
```
1. æ‰“å¼€é…ç½®å·¥å…·
2. è¾“å…¥ API å¯†é’¥å’Œ Base URL
3. ç‚¹å‡»"åˆ·æ–°æ¨¡å‹"æŒ‰é’®
4. ä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©
```

**æ–¹æ³• 2: Python è„šæœ¬**
```python
from mcp_aurai.llm import get_models

models = get_models(
    provider="custom",
    api_key="sk-xxxxx",
    base_url="https://www.chatgtp.cn/v1"
)

print(f"å¯ç”¨æ¨¡å‹: {len(models)} ä¸ª")
for model in models:
    print(f"  - {model}")
```

#### æ¨èæ¨¡å‹

**å¿«é€Ÿå“åº”**ï¼ˆæ¨èè°ƒè¯•ï¼‰:
- zhipu: `glm-4-flash`ï¼ˆä¾¿å®œï¼Œå¿«é€Ÿï¼‰
- openai: `gpt-4o-mini`
- gemini: `gemini-2.0-flash-exp`

**é«˜è´¨é‡è¾“å‡º**ï¼ˆæ¨èç”Ÿäº§ï¼‰:
- zhipu: `glm-4-plus`
- openai: `gpt-4o`
- anthropic: `claude-3-5-sonnet-20241022`
- gemini: `gemini-1.5-pro`

**æˆæœ¬ä¼˜åŒ–**:
- custom æä¾›å•†ï¼ˆå¦‚ chatgtp.cnï¼‰é€šå¸¸æ¯”å®˜æ–¹ä¾¿å®œ 10-50 å€

---

## 4. å¸¸è§é—®é¢˜ (FAQ)

### 4.1 å®‰è£…å’Œé…ç½®

**Q: MCP å·¥å…·æ²¡æœ‰å‡ºç°ï¼Ÿ**

A: æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. **æ£€æŸ¥ MCP é…ç½®çŠ¶æ€**
   ```bash
   claude mcp list
   ```

2. **æŸ¥çœ‹è¯¦ç»†é…ç½®**
   ```bash
   claude mcp get aurai-advisor
   ```

3. **åˆ é™¤å¹¶é‡æ–°æ·»åŠ **
   ```bash
   claude mcp remove aurai-advisor -s local
   claude mcp add aurai-advisor ...
   ```

4. **éªŒè¯ Python è·¯å¾„**
   ```bash
   dir "C:\Users\29493\Desktop\mcp-aurai-server\venv\Scripts\python.exe"
   ```

---

**Q: å¦‚ä½•åœ¨å…¶ä»–ç”µè„‘ä¸Šä½¿ç”¨ï¼Ÿ**

A: ä¸»è¦æ­¥éª¤ï¼š

1. å¤åˆ¶æ•´ä¸ªé¡¹ç›®ç›®å½•
2. åœ¨æ–°ç”µè„‘ä¸Šå®‰è£… Python å’Œä¾èµ–
3. ä¿®æ”¹é…ç½®ä¸­çš„è·¯å¾„
4. è¿è¡Œ `claude mcp add` å‘½ä»¤é…ç½®

è¯¦ç»†æ­¥éª¤è§ [5.2 è·¨å¹³å°å¼€å‘](#52-è·¨å¹³å°å¼€å‘)

---

**Q: å¦‚ä½•å¤‡ä»½æˆ‘çš„é…ç½®ï¼Ÿ**

A:
```bash
# å¯¼å‡ºå½“å‰é…ç½®
claude mcp get aurai-advisor > aurai-config-backup.txt

# å¤‡ä»½å¯¹è¯å†å²ï¼ˆå¦‚æœå¯ç”¨æŒä¹…åŒ–ï¼‰
copy C:\Users\%USERNAME%\.mcp-aurai\history.json D:\backups\history_%date%.json
```

---

### 4.2 API è¿æ¥é—®é¢˜

**Q: å‡ºç° 401 Unauthorized é”™è¯¯ï¼Ÿ**

A: API å¯†é’¥é”™è¯¯æˆ–è¿‡æœŸï¼Œè§£å†³æ–¹æ³•ï¼š

1. æ£€æŸ¥ API å¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç™»å½•æä¾›å•†åå°æŸ¥çœ‹å¯†é’¥çŠ¶æ€
3. é‡æ–°ç”Ÿæˆå¯†é’¥å¹¶æ›´æ–°é…ç½®

---

**Q: å‡ºç° 404 Model not found é”™è¯¯ï¼Ÿ**

A: æ¨¡å‹åç§°é”™è¯¯ï¼Œè§£å†³æ–¹æ³•ï¼š

1. ä½¿ç”¨"åˆ·æ–°æ¨¡å‹"åŠŸèƒ½è·å–æ­£ç¡®åˆ—è¡¨
2. æˆ–è¿è¡Œ Python è„šæœ¬æŸ¥è¯¢ï¼š
   ```python
   from mcp_aurai.llm import get_models
   models = get_models("custom", "your-key", "https://www.chatgtp.cn/v1")
   print(models)
   ```

**å¸¸è§é”™è¯¯åç§°å¯¹ç…§**:
| é”™è¯¯åç§° | æ­£ç¡®åç§° |
|---------|---------|
| deepseekv3.2 | deepseek-v3-1-250821 |
| gpt-4 | gpt-4-turbo |
| claude-3 | claude-3-5-sonnet-20241022 |

---

**Q: å‡ºç° Connection timeout é”™è¯¯ï¼Ÿ**

A: ç½‘ç»œè¿æ¥è¶…æ—¶ï¼Œè§£å†³æ–¹æ³•ï¼š

1. æ£€æŸ¥ç½‘ç»œè¿æ¥
   ```bash
   ping www.chatgtp.cn
   ```

2. æµ‹è¯• HTTPS è¿æ¥
   ```bash
   powershell -Command "Test-NetConnection -ComputerName www.chatgtp.cn -Port 443"
   ```

3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

4. å°è¯•æ›´æ¢ç½‘ç»œæˆ–ä½¿ç”¨ VPN

---

**Q: å‡ºç° 429 Too Many Requests é”™è¯¯ï¼Ÿ**

A: API é™æµï¼Œè§£å†³æ–¹æ³•ï¼š

1. é™ä½è¯·æ±‚é¢‘ç‡
2. æ£€æŸ¥ API é…é¢æ˜¯å¦ç”¨å®Œ
3. å‡çº§ API å¥—é¤
4. æ›´æ¢æä¾›å•†æˆ–å¯†é’¥

---

### 4.3 ä½¿ç”¨é—®é¢˜

**Q: å¯¹è¯å†å²ä¸¢å¤±äº†ï¼Ÿ**

A: æ£€æŸ¥å†å²æ–‡ä»¶ï¼š

```bash
# æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
dir C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json

# æŸ¥çœ‹æ–‡ä»¶å†…å®¹
type C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json

# å¦‚æœæ–‡ä»¶æŸåï¼Œé‡æ–°å¯åŠ¨ä¼šåˆ›å»ºç©ºå†å²
```

**æ¢å¤å¤‡ä»½**:
```bash
copy D:\backups\history_backup.json C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json
```

---

**Q: å¦‚ä½•é™åˆ¶è¿­ä»£æ¬¡æ•°ï¼Ÿ**

A: ä¿®æ”¹é…ç½®ï¼š

```json
{
  "env": {
    "AURAI_MAX_ITERATIONS": "5"  // æœ€å¤š 5 è½®
  }
}
```

---

**Q: å¦‚ä½•æ¸…ç©ºå¯¹è¯å†å²ï¼Ÿ**

A: ä¸¤ç§æ–¹æ³•ï¼š

**æ–¹æ³• 1**: è°ƒç”¨ sync_context å·¥å…·ï¼Œè®¾ç½® `operation="clear"`

**æ–¹æ³• 2**: æ‰‹åŠ¨åˆ é™¤æ–‡ä»¶
```bash
del C:\Users\29493\Desktop\mcp-aurai-server\mcp_conversation_history.json
```

---

**Q: å¦‚ä½•æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼Ÿ**

A: è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º DEBUGï¼š

```json
{
  "env": {
    "AURAI_LOG_LEVEL": "DEBUG"
  }
}
```

æˆ–å‘½ä»¤è¡Œï¼š
```bash
set AURAI_LOG_LEVEL=DEBUG
python -m mcp_aurai.server
```

---

### 4.4 æ€§èƒ½å’Œä¼˜åŒ–

**Q: API å“åº”å¤ªæ…¢ï¼Ÿ**

A: ä¼˜åŒ–å»ºè®®ï¼š

1. **ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹**:
   - zhipu: `glm-4-flash`ï¼ˆæœ€å¿«ï¼‰
   - openai: `gpt-4o-mini`
   - gemini: `gemini-2.0-flash-exp`

2. **å‡å°‘ tokens**:
   ```json
   {
     "env": {
       "AURAI_MAX_TOKENS": "2048"  // é™ä½è¾“å‡ºé•¿åº¦
     }
   }
   ```

3. **é™ä½è¿­ä»£æ¬¡æ•°**:
   ```json
   {
     "env": {
       "AURAI_MAX_ITERATIONS": "5"
     }
   }
   ```

---

**Q: å¦‚ä½•å‡å°‘ API è°ƒç”¨æˆæœ¬ï¼Ÿ**

A: æˆæœ¬ä¼˜åŒ–å»ºè®®ï¼š

1. **ä½¿ç”¨ custom æä¾›å•†**ï¼ˆchatgtp.cn ç­‰ï¼‰
   - æ¯”å®˜æ–¹ä¾¿å®œ 10-50 å€

2. **é€‰æ‹©å¿«é€Ÿæ¨¡å‹**:
   - zhipu: `glm-4-flash`ï¼ˆçº¦ Â¥0.001/1K tokensï¼‰
   - openai: `gpt-4o-mini`ï¼ˆçº¦ $0.001/1K tokensï¼‰

3. **é™åˆ¶è¾“å‡ºé•¿åº¦**:
   ```json
   {
     "env": {
       "AURAI_MAX_TOKENS": "2048"
     }
   }
   ```

4. **å‡å°‘è¿­ä»£æ¬¡æ•°**

---

## 5. è¿›é˜¶æŠ€å·§

### 5.1 é«˜çº§é…ç½®

#### æ¸©åº¦å‚æ•°è°ƒæ•´

**ç”¨é€”**: æ§åˆ¶ AI è¾“å‡ºçš„éšæœºæ€§

| å€¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|----|------|----------|
| 0.0 | å®Œå…¨ç¡®å®šæ€§ | ä»£ç ç”Ÿæˆã€Bug ä¿®å¤ |
| 0.3 | ä½éšæœºæ€§ | æŠ€æœ¯é—®é¢˜è§£å†³ |
| 0.7 | ä¸­ç­‰éšæœºæ€§ | ä¸€èˆ¬å’¨è¯¢ï¼ˆé»˜è®¤ï¼‰ |
| 1.0 | é«˜éšæœºæ€§ | åˆ›æ„é—®é¢˜ |

**é…ç½®**:
```json
{
  "env": {
    "AURAI_TEMPERATURE": "0.3"  // æ›´ç¡®å®šçš„è¾“å‡º
  }
}
```

#### è‡ªå®šä¹‰å†å²è·¯å¾„

**ç”¨é€”**: åˆ†ç¦»ä¸åŒé¡¹ç›®çš„å†å²è®°å½•

```json
{
  "env": {
    "AURAI_HISTORY_PATH": "D:\\projects\\myapp\\mcp_history.json"
  }
}
```

#### æ—¥å¿—é‡å®šå‘

**ç”¨é€”**: è°ƒè¯•å’Œé—®é¢˜æ’æŸ¥

```bash
# é‡å®šå‘åˆ°æ–‡ä»¶
venv\Scripts\python -m mcp_aurai.server > logs\mcp_server.log 2>&1

# æˆ–ä½¿ç”¨ PowerShell
venv\Scripts\python -m mcp_aurai.server *> logs\mcp_server.log
```

---

### 5.2 è·¨å¹³å°å¼€å‘

#### åœ¨å…¶ä»– Windows ç”µè„‘ä¸Šä½¿ç”¨

**æ­¥éª¤**:

1. **å¤åˆ¶é¡¹ç›®**
   ```bash
   # æ–¹å¼ 1: å¤åˆ¶æ•´ä¸ªç›®å½•
   robocopy C:\Users\29493\Desktop\mcp-aurai-server E:\aimcpkaifa /E /XD venv build dist

   # æ–¹å¼ 2: ä½¿ç”¨å¤‡ä»½è„šæœ¬
   venv\Scripts\python scripts\backup_project.py
   # ç„¶åè§£å‹åˆ°æ–°ä½ç½®
   ```

2. **åœ¨æ–°ç”µè„‘ä¸Šå®‰è£…ä¾èµ–**
   ```bash
   cd E:\aimcpkaifa
   python -m venv venv
   venv\Scripts\activate
   pip install -e ".[all-dev]"
   ```

3. **ä¿®æ”¹é…ç½®æ–‡ä»¶**
   ```json
   {
     "mcpServers": {
       "aurai-advisor": {
         "command": "E:\\aimcpkaifa\\venv\\Scripts\\python.exe",  // ä¿®æ”¹è·¯å¾„
         "args": ["-m", "mcp_aurai.server"],
         "env": {
           "AURAI_API_KEY": "new-api-key"  // æ›´æ–°å¯†é’¥
         }
       }
     }
   }
   ```

4. **è¿è¡Œæµ‹è¯•éªŒè¯**
   ```bash
   pytest tests/ -v
   ```

---

#### åœ¨ Linux/Mac ä¸Šä½¿ç”¨

**æ³¨æ„äº‹é¡¹**:
- GUI é…ç½®å·¥å…·ä»…æ”¯æŒ Windows
- éœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œé…ç½®

**æ­¥éª¤**:

1. **å¤åˆ¶é¡¹ç›®**
   ```bash
   # ä½¿ç”¨ rsync æˆ– scp
   rsync -av --exclude='venv' --exclude='build' --exclude='dist' \
       /path/to/aimcpkaifa/ user@linux-server:/path/to/aimcpkaifa/
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   cd /path/to/aimcpkaifa
   python3 -m venv venv
   source venv/bin/activate
   pip install -e ".[all-dev]"
   ```

3. **é…ç½®ç¯å¢ƒå˜é‡**
   ```bash
   # åˆ›å»º .env æ–‡ä»¶
   cat > .env << EOF
   AURAI_API_KEY=your-api-key
   AURAI_PROVIDER=zhipu
   AURAI_MODEL=glm-4-flash
   EOF
   ```

4. **é…ç½® Claude Code (Mac/Linux)**
   ```bash
   claude mcp add aurai-advisor \
     -e AURAI_API_KEY="your-api-key" \
     -e AURAI_PROVIDER="zhipu" \
     -e AURAI_MODEL="glm-4-flash" \
     -- "/path/to/aimcpkaifa/venv/bin/python" -m mcp_aurai.server
   ```

---

### 5.3 å¤‡ä»½å’Œæ¢å¤

#### åˆ›å»ºé¡¹ç›®å¤‡ä»½

**ä½¿ç”¨å¤‡ä»½è„šæœ¬**:
```bash
cd C:\Users\29493\Desktop\mcp-aurai-server
venv\Scripts\python scripts\backup_project.py
```

**å¤‡ä»½å†…å®¹**:
- âœ… æ‰€æœ‰æºä»£ç ï¼ˆsrc/ï¼‰
- âœ… æµ‹è¯•æ–‡ä»¶ï¼ˆtests/ï¼‰
- âœ… å·¥å…·è„šæœ¬ï¼ˆtools/, scripts/ï¼‰
- âœ… æ–‡æ¡£ï¼ˆdocs/ï¼‰
- âœ… é…ç½®æ–‡ä»¶ï¼ˆ*.md, *.toml, .env.exampleï¼‰

**æ’é™¤å†…å®¹**:
- âŒ venv/ï¼ˆè™šæ‹Ÿç¯å¢ƒï¼‰
- âŒ __pycache__/ï¼ˆç¼“å­˜ï¼‰
- âŒ .git/ï¼ˆç‰ˆæœ¬æ§åˆ¶ï¼‰
- âŒ build/, dist/ï¼ˆæ„å»ºäº§ç‰©ï¼‰

**å¤‡ä»½ä½ç½®**: `D:\backups\mcp-aurai-advisor-TIMESTAMP.zip`

#### æ¢å¤é¡¹ç›®

**æ­¥éª¤**:

1. **è§£å‹å¤‡ä»½**
   ```bash
   # è§£å‹åˆ°æ–°ä½ç½®
   unzip D:\backups\mcp-aurai-advisor-20260116-133751.zip -d C:\Users\29493\Desktop\mcp-aurai-server_new
   ```

2. **é‡æ–°åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
   ```bash
   cd C:\Users\29493\Desktop\mcp-aurai-server_new
   python -m venv venv
   venv\Scripts\activate
   pip install -e ".[all-dev]"
   ```

3. **æ¢å¤é…ç½®**
   ```bash
   # å¤åˆ¶ .env æ–‡ä»¶
   copy D:\backups\.env .env

   # æˆ–é‡æ–°é…ç½®
   copy .env.example .env
   notepad .env
   ```

---

### 5.4 æ€§èƒ½ç›‘æ§

#### æŸ¥çœ‹ API è°ƒç”¨ç»Ÿè®¡

**æ–¹æ³• 1: æŸ¥çœ‹æ—¥å¿—**
```bash
# ç»Ÿè®¡ API è°ƒç”¨æ¬¡æ•°
findstr /C:"api_call" logs\mcp_server.log | find /c /v ""

# æŸ¥çœ‹é”™è¯¯
findstr /C:"ERROR" logs\mcp_server.log
```

**æ–¹æ³• 2: æ·»åŠ è‡ªå®šä¹‰ç»Ÿè®¡**
```python
# åœ¨ä»£ç ä¸­æ·»åŠ 
import time

start = time.time()
result = await client.chat(messages)
latency = time.time() - start

print(f"API è°ƒç”¨è€—æ—¶: {latency:.2f}ç§’")
```

---

### 5.5 æ•…éšœæ’æŸ¥æµç¨‹

#### å®Œæ•´æ’æŸ¥æµç¨‹

```
é—®é¢˜å‡ºç°
    â”‚
    â”œâ”€â–º æ£€æŸ¥é…ç½®æ–‡ä»¶
    â”‚   â””â”€â–º JSON æ ¼å¼æ˜¯å¦æ­£ç¡®
    â”‚   â””â”€â–º è·¯å¾„æ˜¯å¦æ­£ç¡®
    â”‚   â””â”€â–º API å¯†é’¥æ˜¯å¦æœ‰æ•ˆ
    â”‚
    â”œâ”€â–º æ£€æŸ¥ç½‘ç»œè¿æ¥
    â”‚   â””â”€â–º ping æä¾›å•†æœåŠ¡å™¨
    â”‚   â””â”€â–º æµ‹è¯• HTTPS è¿æ¥
    â”‚   â””â”€â–º æ£€æŸ¥é˜²ç«å¢™
    â”‚
    â”œâ”€â–º æŸ¥çœ‹æ—¥å¿—
    â”‚   â””â”€â–º è®¾ç½® DEBUG çº§åˆ«
    â”‚   â””â”€â–º æŸ¥æ‰¾é”™è¯¯ä¿¡æ¯
    â”‚   â””â”€â–º åˆ†æå †æ ˆè·Ÿè¸ª
    â”‚
    â”œâ”€â–º è¿è¡Œæµ‹è¯•
    â”‚   â””â”€â–º pytest tests/ -v
    â”‚   â””â”€â–º éªŒè¯ç¯å¢ƒé…ç½®
    â”‚   â””â”€â–º æ£€æŸ¥ä¾èµ–å®‰è£…
    â”‚
    â””â”€â–º å¯»æ±‚å¸®åŠ©
        â”œâ”€â–º æŸ¥çœ‹æ–‡æ¡£
        â”œâ”€â–º æŸ¥çœ‹å¸¸è§é—®é¢˜
        â””â”€â–º æäº¤ Issue
```

---

## é™„å½•

### A. å®Œæ•´é…ç½®ç¤ºä¾‹

**Claude Code é…ç½®**ï¼ˆå®Œæ•´ç‰ˆï¼‰:
```bash
claude mcp add aurai-advisor \
  -e AURAI_API_KEY="your-api-key" \
  -e AURAI_PROVIDER="custom" \
  -e AURAI_BASE_URL="https://www.chatgtp.cn/v1" \
  -e AURAI_MODEL="deepseek-v3-1-250821" \
  -e AURAI_MAX_ITERATIONS="10" \
  -e AURAI_TEMPERATURE="0.7" \
  -e AURAI_MAX_TOKENS="4096" \
  -e AURAI_HISTORY_PATH="D:\\aimcpkaifa\\mcp_conversation_history.json" \
  -e AURAI_LOG_LEVEL="INFO" \
  -- "D:\\aimcpkaifa\\venv\\Scripts\\python.exe" -m mcp_aurai.server
```

### B. ç¯å¢ƒå˜é‡é€ŸæŸ¥è¡¨

```bash
# å¿…éœ€
AURAI_API_KEY=xxx                    # API å¯†é’¥

# åŸºç¡€é…ç½®
AURAI_PROVIDER=zhipu                 # æä¾›å•†
AURAI_MODEL=glm-4-flash             # æ¨¡å‹
AURAI_BASE_URL=https://api.com/v1   # Base URL

# é«˜çº§é…ç½®
AURAI_MAX_ITERATIONS=10              # æœ€å¤§è¿­ä»£
AURAI_TEMPERATURE=0.7                # æ¸©åº¦å‚æ•°
AURAI_MAX_TOKENS=4096                # æœ€å¤§ tokens

# å…¶ä»–
AURAI_HISTORY_PATH=xxx.json          # å†å²æ–‡ä»¶è·¯å¾„
AURAI_LOG_LEVEL=INFO                 # æ—¥å¿—çº§åˆ«
```

### C. å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# å®‰è£…
python -m venv venv && venv\Scripts\activate
pip install -e ".[all-dev]"

# æµ‹è¯•
pytest tests/ -v

# è¿è¡Œ
python -m mcp_aurai.server
python tools/config_gui.py

# å¤‡ä»½
venv\Scripts\python scripts\backup_project.py

# æ—¥å¿—
set AURAI_LOG_LEVEL=DEBUG
python -m mcp_aurai.server > logs\server.log 2>&1
```

### D. è·å–å¸®åŠ©

**æ–‡æ¡£èµ„æº**:
- README.md - é¡¹ç›®æ¦‚è¿°
- docs/å¼€å‘æ–‡æ¡£.md - æŠ€æœ¯ç»†èŠ‚
- docs/FAQ.md - å¸¸è§é—®é¢˜

**åœ¨çº¿èµ„æº**:
- MCP å®˜æ–¹æ–‡æ¡£: https://modelcontextprotocol.io/
- FastMCP æ–‡æ¡£: https://github.com/jlowin/fastmcp

**è·å– API å¯†é’¥**:
- æ™ºè°± AI: https://open.bigmodel.cn/
- OpenAI: https://platform.openai.com/api-keys
- Anthropic: https://console.anthropic.com/
- Gemini: https://makersuite.google.com/app/apikey

---

**ç‰ˆæœ¬**: v2.1 | **æ›´æ–°æ—¥æœŸ**: 2026-01-21 | **é¡¹ç›®çŠ¶æ€**: 100% å®Œæˆ [OK]
